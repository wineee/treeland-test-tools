# Treeland 应用程序压力测试工具

这个工具用于测试 Wayland 合成器对频繁启动和关闭应用程序的处理能力。它会从预定义的应用程序列表中随机选择程序启动，可以控制启动间隔和最大进程数。

## 功能特点

- 随机启动预定义的应用程序列表
- 可配置的启动间隔时间
- 可限制最大同时运行的进程数
- 支持自定义应用程序列表（JSON格式）
- 自动清理已退出的进程
- 详细的测试统计信息
- 支持设置测试持续时间

## 使用方法

基本用法：
```bash
./test_apps.py
```

使用自定义参数：
```bash
# 使用0.5秒的启动间隔，最多同时运行5个进程
./test_apps.py --interval 0.5 --max-processes 5

# 使用自定义应用程序列表文件
./test_apps.py --app-list my_apps.json

# 运行30秒后自动停止
./test_apps.py --duration 30
```

### 命令行参数

- `--interval <秒数>`：应用程序启动间隔（默认：0.1秒）
- `--max-processes <数量>`：最大同时运行的进程数（默认：10个）
- `--duration <秒数>`：测试持续时间（默认：0，表示持续运行直到中断）
- `--app-list <文件路径>`：自定义应用程序列表文件的路径

## 应用程序列表格式

应用程序列表使用JSON格式，例如：
```json
[
  {
    "name": "foot",
    "command": "foot",
    "category": "terminal"
  },
  {
    "name": "deepin-terminal",
    "command": "deepin-terminal",
    "category": "terminal"
  }
]
```

每个应用程序需要包含以下字段：
- `name`：应用程序名称
- `command`：启动命令
- `category`：应用程序类别（可选）

## 系统要求

- Python 3.6 或更高版本
- psutil 库（用于进程管理）
- 被测试的应用程序需要已经安装在系统中

## 安装

1. 安装必要的 Python 包：
   ```bash
   pip install psutil
   ```

2. 确保脚本具有执行权限：
   ```bash
   chmod +x test_apps.py
   ```

## 注意事项

1. 运行测试前请确保系统有足够的资源
2. 建议先用较大的启动间隔进行测试，再逐步减小间隔
3. 如果系统资源紧张，可以通过 `--max-processes` 限制同时运行的进程数
4. 可以随时按 Ctrl+C 中断测试，脚本会自动清理所有启动的进程
5. 某些应用程序可能需要特定的环境变量或配置才能正常启动

## 调试

如果遇到问题，脚本会显示：
- 每个应用程序的启动状态
- 当前运行的进程数量
- 进程清理情况
- 测试完成后的统计信息

## 已知问题

1. 某些应用程序可能不会正确响应终止信号
2. 图形应用程序可能需要特定的显示环境变量
3. 启动失败的应用程序会被记录但不会重试

## 贡献

欢迎提交问题报告和改进建议！

## 许可证

使用 MIT 许可证
