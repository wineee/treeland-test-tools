# Treeland 显示器配置测试工具

这个工具用于自动化测试 Wayland 合成器（特别是 Treeland）的显示器配置功能。它使用 `wlr-randr` 工具按照预设的顺序测试各种显示器设置，包括分辨率、刷新率、旋转方向和缩放比例。

## 功能特点

- 自动检测并测试所有已连接的显示器
- 全面的显示器配置测试：
  - 分辨率和刷新率组合
  - 屏幕旋转方向
  - 显示缩放
- 详细的测试结果报告
- 支持自定义测试间隔时间
- 错误处理和恢复机制

## 测试内容

### 1. 分辨率和刷新率测试
- 遍历显示器支持的所有分辨率和刷新率组合
- 自动验证每个模式是否成功应用
- 测试后恢复初始分辨率

### 2. 屏幕方向测试
- 使用 preferred 模式作为基准分辨率
- 测试 8 种旋转方向：
  * normal: 正常方向
  * 90/180/270: 顺时针旋转相应角度
  * flipped: 水平翻转
  * flipped-90/180/270: 水平翻转后再旋转
- 测试后恢复初始方向

### 3. 显示比例测试
- 使用 preferred 模式和 normal 方向
- 测试不同缩放值（0.5-1.5，步长0.2）
- 测试序列：0.5, 0.7, 0.9, 1.1, 1.3, 1.5
- 测试后恢复初始缩放值

## 系统要求

- Python 3.6 或更高版本
- wlr-randr 工具
- Wayland 合成器（如 Treeland）

## 安装

1. 确保系统已安装 wlr-randr：
   ```bash
   # 在 Debian/Ubuntu 系统上：
   sudo apt install wlr-randr

   # 在 Arch Linux 系统上：
   sudo pacman -S wlr-randr
   ```

2. 克隆仓库并进入目录：
   ```bash
   cd test/screen
   ```

3. 确保脚本具有执行权限：
   ```bash
   chmod +x test_display.py
   ```

## 使用方法

基本用法：
```bash
./test_display.py
```

使用自定义间隔时间：
```bash
./test_display.py --interval 0.5  # 使用0.5秒的间隔
```

### 命令行参数

- `--interval <秒数>`：设置配置更改之间的等待时间（默认：1.0秒）

## 注意事项

1. 确保在运行测试之前保存所有工作，因为显示器配置可能会暂时变得难以使用
2. 某些显示器可能不支持特定的配置组合，这是正常的
3. 可以随时按 Ctrl+C 中断测试
4. 测试过程中如果出现问题，等待几秒钟配置就会自动恢复

## 调试

如果遇到问题，脚本会显示详细的调试信息：
- 原始的 wlr-randr 输出
- 解析过程的每一步
- 每个配置变更的结果
- 测试统计信息

## 常见问题

1. **某些分辨率/刷新率组合失败**
   - 这是正常的，不是所有组合都被显示器支持

2. **某些旋转方向不起作用**
   - 部分显示器或显卡可能不支持某些旋转方向

3. **缩放值设置失败**
   - 某些 Wayland 合成器可能限制了缩放范围
   - 显卡驱动可能不支持某些缩放值

## 贡献

欢迎提交问题报告和改进建议！

## 许可证

使用 MIT 许可证
